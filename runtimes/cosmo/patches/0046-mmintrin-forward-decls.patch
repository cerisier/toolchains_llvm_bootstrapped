--- a/third_party/intel/mmintrin.internal.h
+++ b/third_party/intel/mmintrin.internal.h
@@ -12,7 +12,57 @@
 #endif
 #define __DISABLE_MMX__
 #endif
-typedef int __m64 __attribute__ ((__vector_size__ (8), __may_alias__));
+typedef long long __m64 __attribute__ ((__vector_size__ (8), __may_alias__));
+/* Forward declarations for helpers referenced before their definitions. */
+extern __inline __m64 __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_setr_pi32 (int __i0, int __i1);
+extern __inline __m64 __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_setr_pi16 (short __w0, short __w1, short __w2, short __w3);
+extern __inline __m64 __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_setr_pi8 (char __b0, char __b1, char __b2, char __b3,
+       char __b4, char __b5, char __b6, char __b7);
+
+/* Immediate shift helpers (missing in the original header). */
+extern __inline __v4hi __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_sll_pi16i (__v4hi __m, int __count)
+{
+  return __builtin_ia32_psllwi (__m, __count);
+}
+extern __inline __v2si __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_sll_pi32i (__v2si __m, int __count)
+{
+  return __builtin_ia32_pslldi (__m, __count);
+}
+extern __inline __v1di __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_sll_si64i (__v1di __m, int __count)
+{
+  return __builtin_ia32_psllqi (__m, __count);
+}
+extern __inline __v4hi __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_sra_pi16i (__v4hi __m, int __count)
+{
+  return __builtin_ia32_psrawi (__m, __count);
+}
+extern __inline __v2si __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_sra_pi32i (__v2si __m, int __count)
+{
+  return __builtin_ia32_psradi (__m, __count);
+}
+extern __inline __v4hi __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_srl_pi16i (__v4hi __m, int __count)
+{
+  return __builtin_ia32_psrlwi (__m, __count);
+}
+extern __inline __v2si __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_srl_pi32i (__v2si __m, int __count)
+{
+  return __builtin_ia32_psrldi (__m, __count);
+}
+extern __inline __v1di __attribute__((__gnu_inline__, __always_inline__, __artificial__))
+_mm_srl_si64i (__v1di __m, int __count)
+{
+  return __builtin_ia32_psrlqi (__m, __count);
+}
 typedef int __m32 __attribute__ ((__vector_size__ (4), __may_alias__));
 typedef short __m16 __attribute__ ((__vector_size__ (2), __may_alias__));
 typedef int __m64_u __attribute__ ((__vector_size__ (8), __may_alias__, __aligned__ (1)));
