--- a/third_party/intel/clang/avx512vpopcntdqintrin.h
+++ b/third_party/intel/clang/avx512vpopcntdqintrin.h
@@ -15,6 +15,11 @@
 #ifndef __AVX512VPOPCNTDQINTRIN_H
 #define __AVX512VPOPCNTDQINTRIN_H
 
+#if !__has_builtin(__builtin_ia32_vpopcntq_512)
+#define __DISABLE_AVX512VPOPCNTDQ__ 1
+#endif /* __DISABLE_AVX512VPOPCNTDQ__ */
+
+#if !defined(__DISABLE_AVX512VPOPCNTDQ__)
 /* Define the default attributes for the functions in this file. */
 #define __DEFAULT_FN_ATTRS                                                     \
   __attribute__((__always_inline__, __nodebug__,                               \
@@ -50,6 +55,44 @@
 _mm512_maskz_popcnt_epi32(__mmask16 __U, __m512i __A) {
   return _mm512_mask_popcnt_epi32((__m512i)_mm512_setzero_si512(), __U, __A);
 }
+#else
+#define __DEFAULT_FN_ATTRS                                                     \
+  __attribute__((__always_inline__, __nodebug__,                               \
+                 __target__("avx512vpopcntdq,evex512"),                        \
+                 __min_vector_width__(512)))
+static __inline__ __m512i __DEFAULT_FN_ATTRS _mm512_popcnt_epi64(__m512i __A) {
+  (void)__A;
+  return (__m512i){0};
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_mask_popcnt_epi64(__m512i __W, __mmask8 __U, __m512i __A) {
+  (void)__U;
+  (void)__A;
+  return __W;
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_maskz_popcnt_epi64(__mmask8 __U, __m512i __A) {
+  (void)__U;
+  (void)__A;
+  return (__m512i){0};
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS _mm512_popcnt_epi32(__m512i __A) {
+  (void)__A;
+  return (__m512i){0};
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_mask_popcnt_epi32(__m512i __W, __mmask16 __U, __m512i __A) {
+  (void)__U;
+  (void)__A;
+  return __W;
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_maskz_popcnt_epi32(__mmask16 __U, __m512i __A) {
+  (void)__U;
+  (void)__A;
+  return (__m512i){0};
+}
+#endif /* __DISABLE_AVX512VPOPCNTDQ__ */
 
 #undef __DEFAULT_FN_ATTRS
 
--- a/third_party/intel/clang/avx512vpopcntdqvlintrin.h
+++ b/third_party/intel/clang/avx512vpopcntdqvlintrin.h
@@ -15,6 +15,12 @@
 #ifndef __AVX512VPOPCNTDQVLINTRIN_H
 #define __AVX512VPOPCNTDQVLINTRIN_H
 
+#if !__has_builtin(__builtin_ia32_vpopcntq_256)
+#define __DISABLE_AVX512VPOPCNTDQVLINTRIN_H 1
+#endif /* __DISABLE_AVX512VPOPCNTDQVLINTRIN_H */
+
+#if !defined(__DISABLE_AVX512VPOPCNTDQVLINTRIN_H)
+
 /* Define the default attributes for the functions in this file. */
 #define __DEFAULT_FN_ATTRS128                                                  \
   __attribute__((__always_inline__, __nodebug__,                               \
@@ -88,6 +94,82 @@
 _mm256_maskz_popcnt_epi32(__mmask8 __U, __m256i __A) {
   return _mm256_mask_popcnt_epi32((__m256i)_mm256_setzero_si256(), __U, __A);
 }
+#else
+#define __DEFAULT_FN_ATTRS128                                                  \
+  __attribute__((__always_inline__, __nodebug__, __target__("avx512vpopcntdq"),\
+                 __min_vector_width__(128)))
+#define __DEFAULT_FN_ATTRS256                                                  \
+  __attribute__((__always_inline__, __nodebug__, __target__("avx512vpopcntdq"),\
+                 __min_vector_width__(256)))
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_popcnt_epi64(__m128i __A) {
+  (void)__A;
+  return (__m128i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_mask_popcnt_epi64(__m128i __W, __mmask8 __U, __m128i __A) {
+  (void)__U;
+  (void)__A;
+  return __W;
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_maskz_popcnt_epi64(__mmask8 __U, __m128i __A) {
+  (void)__U;
+  (void)__A;
+  return (__m128i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_popcnt_epi64(__m256i __A) {
+  (void)__A;
+  return (__m256i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_mask_popcnt_epi64(__m256i __W, __mmask8 __U, __m256i __A) {
+  (void)__U;
+  (void)__A;
+  return __W;
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_maskz_popcnt_epi64(__mmask8 __U, __m256i __A) {
+  (void)__U;
+  (void)__A;
+  return (__m256i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_popcnt_epi32(__m128i __A) {
+  (void)__A;
+  return (__m128i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_mask_popcnt_epi32(__m128i __W, __mmask8 __U, __m128i __A) {
+  (void)__U;
+  (void)__A;
+  return __W;
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_maskz_popcnt_epi32(__mmask8 __U, __m128i __A) {
+  (void)__U;
+  (void)__A;
+  return (__m128i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_popcnt_epi32(__m256i __A) {
+  (void)__A;
+  return (__m256i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_mask_popcnt_epi32(__m256i __W, __mmask8 __U, __m256i __A) {
+  (void)__U;
+  (void)__A;
+  return __W;
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_maskz_popcnt_epi32(__mmask8 __U, __m256i __A) {
+  (void)__U;
+  (void)__A;
+  return (__m256i){0};
+}
+#endif /* __DISABLE_AVX512VPOPCNTDQVLINTRIN_H */
 
 #undef __DEFAULT_FN_ATTRS128
 #undef __DEFAULT_FN_ATTRS256
--- a/third_party/intel/clang/avx512bitalgintrin.h
+++ b/third_party/intel/clang/avx512bitalgintrin.h
@@ -14,12 +14,17 @@
 #ifndef __AVX512BITALGINTRIN_H
 #define __AVX512BITALGINTRIN_H
 
+#if !__has_builtin(__builtin_ia32_vpopcntw_512)
+#define __DISABLE_AVX512BITALGINTRIN_H 1
+#endif /* __DISABLE_AVX512BITALGINTRIN_H */
+
 /* Define the default attributes for the functions in this file. */
 #define __DEFAULT_FN_ATTRS                                                     \
   __attribute__((__always_inline__, __nodebug__,                               \
                  __target__("avx512bitalg,evex512"),                           \
                  __min_vector_width__(512)))
 
+#if !defined(__DISABLE_AVX512BITALGINTRIN_H)
 static __inline__ __m512i __DEFAULT_FN_ATTRS
 _mm512_popcnt_epi16(__m512i __A)
 {
@@ -63,6 +68,48 @@
               __U,
               __B);
 }
+#else
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_popcnt_epi16(__m512i __A)
+{
+  (void)__A;
+  return (__m512i){0};
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_mask_popcnt_epi16(__m512i __A, __mmask32 __U, __m512i __B)
+{
+  (void)__U;
+  (void)__B;
+  return __A;
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_maskz_popcnt_epi16(__mmask32 __U, __m512i __B)
+{
+  (void)__U;
+  (void)__B;
+  return (__m512i){0};
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_popcnt_epi8(__m512i __A)
+{
+  (void)__A;
+  return (__m512i){0};
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_mask_popcnt_epi8(__m512i __A, __mmask64 __U, __m512i __B)
+{
+  (void)__U;
+  (void)__B;
+  return __A;
+}
+static __inline__ __m512i __DEFAULT_FN_ATTRS
+_mm512_maskz_popcnt_epi8(__mmask64 __U, __m512i __B)
+{
+  (void)__U;
+  (void)__B;
+  return (__m512i){0};
+}
+#endif /* __DISABLE_AVX512BITALGINTRIN_H */
 
 static __inline__ __mmask64 __DEFAULT_FN_ATTRS
 _mm512_mask_bitshuffle_epi64_mask(__mmask64 __U, __m512i __A, __m512i __B)
--- a/third_party/intel/clang/avx512vlbitalgintrin.h
+++ b/third_party/intel/clang/avx512vlbitalgintrin.h
@@ -14,6 +14,10 @@
 #ifndef __AVX512VLBITALGINTRIN_H
 #define __AVX512VLBITALGINTRIN_H
 
+#if !__has_builtin(__builtin_ia32_vpopcntw_256)
+#define __DISABLE_AVX512VLBITALGINTRIN_H 1
+#endif /* __DISABLE_AVX512VLBITALGINTRIN_H */
+
 /* Define the default attributes for the functions in this file. */
 #define __DEFAULT_FN_ATTRS128                                                  \
   __attribute__((__always_inline__, __nodebug__,                               \
@@ -24,6 +28,7 @@
                  __target__("avx512vl,avx512bitalg,no-evex512"),               \
                  __min_vector_width__(256)))
 
+#if !defined(__DISABLE_AVX512VLBITALGINTRIN_H)
 static __inline__ __m256i __DEFAULT_FN_ATTRS256
 _mm256_popcnt_epi16(__m256i __A)
 {
@@ -111,6 +116,88 @@
               __U,
               __B);
 }
+#else
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_popcnt_epi16(__m256i __A)
+{
+  (void)__A;
+  return (__m256i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_mask_popcnt_epi16(__m256i __A, __mmask16 __U, __m256i __B)
+{
+  (void)__U;
+  (void)__B;
+  return __A;
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_maskz_popcnt_epi16(__mmask16 __U, __m256i __B)
+{
+  (void)__U;
+  (void)__B;
+  return (__m256i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_popcnt_epi16(__m128i __A)
+{
+  (void)__A;
+  return (__m128i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_mask_popcnt_epi16(__m128i __A, __mmask8 __U, __m128i __B)
+{
+  (void)__U;
+  (void)__B;
+  return __A;
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_maskz_popcnt_epi16(__mmask8 __U, __m128i __B)
+{
+  (void)__U;
+  (void)__B;
+  return (__m128i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_popcnt_epi8(__m256i __A)
+{
+  (void)__A;
+  return (__m256i){0};
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_mask_popcnt_epi8(__m256i __A, __mmask32 __U, __m256i __B)
+{
+  (void)__U;
+  (void)__B;
+  return __A;
+}
+static __inline__ __m256i __DEFAULT_FN_ATTRS256
+_mm256_maskz_popcnt_epi8(__mmask32 __U, __m256i __B)
+{
+  (void)__U;
+  (void)__B;
+  return (__m256i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_popcnt_epi8(__m128i __A)
+{
+  (void)__A;
+  return (__m128i){0};
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_mask_popcnt_epi8(__m128i __A, __mmask16 __U, __m128i __B)
+{
+  (void)__U;
+  (void)__B;
+  return __A;
+}
+static __inline__ __m128i __DEFAULT_FN_ATTRS128
+_mm_maskz_popcnt_epi8(__mmask16 __U, __m128i __B)
+{
+  (void)__U;
+  (void)__B;
+  return (__m128i){0};
+}
+#endif /* __DISABLE_AVX512VLBITALGINTRIN_H */
 
 static __inline__ __mmask32 __DEFAULT_FN_ATTRS256
 _mm256_mask_bitshuffle_epi64_mask(__mmask32 __U, __m256i __A, __m256i __B)
