--- a/libc/intrin/demangle.c
+++ b/libc/intrin/demangle.c
@@ -31,7 +31,18 @@
 #include <stdbool.h>
 #include <stddef.h>
 #include <stdint.h>
+#include "libc/runtime/runtime.h"
 
+#if defined(__aarch64__)
+#define DEMANGLE_JMPBUF jmp_buf
+#define DEMANGLE_SETJMP(env) setjmp(env)
+#define DEMANGLE_LONGJMP(env, val) longjmp(env, val)
+#else
+#define DEMANGLE_JMPBUF intptr_t[5]
+#define DEMANGLE_SETJMP(env) __builtin_setjmp(env)
+#define DEMANGLE_LONGJMP(env, val) __builtin_longjmp(env, val)
+#endif
+
 __notice(demangle_notice, "\
 Cosmopolitan libelftc demangle (BSD-2)\n\
 Copyright (c) 2007 Hyogeol Lee <hyogeollee@gmail.com>\n\
@@ -194,7 +205,7 @@
 	int depth;
 	const char *cur;	/* current mangled name ptr */
 	const char *last_sname; /* last source name */
-	intptr_t jmpbuf[5];
+	DEMANGLE_JMPBUF jmpbuf;
 };
 
 struct type_delimit {
@@ -395,7 +406,7 @@
 	long b = sizeof(index_t);
 
 	if (n < 0 || n >= 32768)
-		__builtin_longjmp(h->jmpbuf, 1);
+		DEMANGLE_LONGJMP(h->jmpbuf, 1);
 
 	/* Roundup size. */
 	n += a - 1;
@@ -438,7 +449,7 @@
 		((index_t *)ptr)[-1] = n;
 		return (void *)ptr;
 	} else {
-		__builtin_longjmp(h->jmpbuf, 1);
+		DEMANGLE_LONGJMP(h->jmpbuf, 1);
 	}
 }
 
@@ -2552,7 +2563,7 @@
 demangle_read_expression(struct demangle_data *ddata)
 {
 	if (ddata->depth == MAX_DEPTH)
-		__builtin_longjmp(ddata->jmpbuf, 1);
+		DEMANGLE_LONGJMP(ddata->jmpbuf, 1);
 	++ddata->depth;
 	int res = demangle_read_expression_impl(ddata);
 	--ddata->depth;
@@ -2881,7 +2892,7 @@
 
 	len = demangle_strtol(ddata->cur, 10);
 	if (len < 0)
-		__builtin_longjmp(ddata->jmpbuf, 1);
+		DEMANGLE_LONGJMP(ddata->jmpbuf, 1);
 
 	while (ELFTC_ISDIGIT(*ddata->cur))
 		++ddata->cur;
@@ -3121,7 +3132,7 @@
 demangle_read_encoding(struct demangle_data *ddata)
 {
 	if (ddata->depth == MAX_DEPTH)
-		__builtin_longjmp(ddata->jmpbuf, 1);
+		DEMANGLE_LONGJMP(ddata->jmpbuf, 1);
 	++ddata->depth;
 	int res = demangle_read_encoding_impl(ddata);
 	--ddata->depth;
@@ -3363,7 +3374,7 @@
 demangle_read_name(struct demangle_data *ddata)
 {
 	if (ddata->depth == MAX_DEPTH)
-		__builtin_longjmp(ddata->jmpbuf, 1);
+		DEMANGLE_LONGJMP(ddata->jmpbuf, 1);
 	++ddata->depth;
 	int res = demangle_read_name_impl(ddata);
 	--ddata->depth;
@@ -4262,7 +4273,7 @@
 demangle_read_type(struct demangle_data *ddata, struct type_delimit *td)
 {
 	if (ddata->depth == MAX_DEPTH)
-		__builtin_longjmp(ddata->jmpbuf, 1);
+		DEMANGLE_LONGJMP(ddata->jmpbuf, 1);
 	++ddata->depth;
 	int res = demangle_read_type_impl(ddata, td);
 	--ddata->depth;
@@ -4455,7 +4466,7 @@
 __demangle(char *buf, const char *org, size_t buflen)
 {
 	struct demangle_data ddata[1];
-	if (!__builtin_setjmp(ddata->jmpbuf))
+	if (!DEMANGLE_SETJMP(ddata->jmpbuf))
 		return demangle(ddata, buf, org, buflen);
 	return demangle_failure(buf, org, buflen);
 }
--- a/libc/intrin/feenableexcept.c
+++ b/libc/intrin/feenableexcept.c
@@ -78,12 +78,14 @@
 
 #elif defined(__aarch64__)
 
-  unsigned fpcr = __builtin_aarch64_get_fpcr();
+  unsigned fpcr;
   unsigned want = excepts << 8;
-  unsigned fpcr2 = fpcr | want;
+  unsigned fpcr2;
+  asm volatile("mrs %0, fpcr" : "=r"(fpcr));
+  fpcr2 = fpcr | want;
   if (fpcr != fpcr2) {
-    __builtin_aarch64_set_fpcr(fpcr2);
-    fpcr2 = __builtin_aarch64_get_fpsr();
+    asm volatile("msr fpcr, %0" : : "r"(fpcr2));
+    asm volatile("mrs %0, fpsr" : "=r"(fpcr2));
     if ((fpcr2 & want) != want)
       return -1;  // not supported by cpu
   }
--- a/libc/intrin/fedisableexcept.c
+++ b/libc/intrin/fedisableexcept.c
@@ -80,10 +80,10 @@
 
   unsigned fpcr;
   unsigned fpcr2;
-  fpcr = __builtin_aarch64_get_fpcr();
+  asm volatile("mrs %0, fpcr" : "=r"(fpcr));
   fpcr2 = fpcr & ~(excepts << 8);
   if (fpcr != fpcr2)
-    __builtin_aarch64_set_fpcr(fpcr2);
+    asm volatile("msr fpcr, %0" : : "r"(fpcr2));
   return (fpcr >> 8) & FE_ALL_EXCEPT;
 
 #else
--- a/third_party/aarch64/clang/arm_neon.h
+++ b/third_party/aarch64/clang/arm_neon.h
@@ -65620,9 +65620,9 @@
 
 __ai __attribute__((target("v8.3a,neon"))) float64x1_t vcmla_f64(float64x1_t __p0, float64x1_t __p1, float64x1_t __p2) {
   float64x1_t __ret;
-  float64x2_t __va = vcombine_f64(__p0, (float64_t)0);
-  float64x2_t __vb = vcombine_f64(__p1, (float64_t)0);
-  float64x2_t __vc = vcombine_f64(__p2, (float64_t)0);
+  float64x2_t __va = vcombine_f64(__p0, vdup_n_f64(0.0));
+  float64x2_t __vb = vcombine_f64(__p1, vdup_n_f64(0.0));
+  float64x2_t __vc = vcombine_f64(__p2, vdup_n_f64(0.0));
   float64x2_t __vres = vcmlaq_f64(__va, __vb, __vc);
   __ret = vget_low_f64(__vres);
   return __ret;
@@ -65742,9 +65742,9 @@
 
 __ai __attribute__((target("v8.3a,neon"))) float64x1_t vcmla_rot180_f64(float64x1_t __p0, float64x1_t __p1, float64x1_t __p2) {
   float64x1_t __ret;
-  float64x2_t __va = vcombine_f64(__p0, (float64_t)0);
-  float64x2_t __vb = vcombine_f64(__p1, (float64_t)0);
-  float64x2_t __vc = vcombine_f64(__p2, (float64_t)0);
+  float64x2_t __va = vcombine_f64(__p0, vdup_n_f64(0.0));
+  float64x2_t __vb = vcombine_f64(__p1, vdup_n_f64(0.0));
+  float64x2_t __vc = vcombine_f64(__p2, vdup_n_f64(0.0));
   float64x2_t __vres = vcmlaq_rot180_f64(__va, __vb, __vc);
   __ret = vget_low_f64(__vres);
   return __ret;
@@ -65864,9 +65864,9 @@
 
 __ai __attribute__((target("v8.3a,neon"))) float64x1_t vcmla_rot270_f64(float64x1_t __p0, float64x1_t __p1, float64x1_t __p2) {
   float64x1_t __ret;
-  float64x2_t __va = vcombine_f64(__p0, (float64_t)0);
-  float64x2_t __vb = vcombine_f64(__p1, (float64_t)0);
-  float64x2_t __vc = vcombine_f64(__p2, (float64_t)0);
+  float64x2_t __va = vcombine_f64(__p0, vdup_n_f64(0.0));
+  float64x2_t __vb = vcombine_f64(__p1, vdup_n_f64(0.0));
+  float64x2_t __vc = vcombine_f64(__p2, vdup_n_f64(0.0));
   float64x2_t __vres = vcmlaq_rot270_f64(__va, __vb, __vc);
   __ret = vget_low_f64(__vres);
   return __ret;
@@ -65986,9 +65986,9 @@
 
 __ai __attribute__((target("v8.3a,neon"))) float64x1_t vcmla_rot90_f64(float64x1_t __p0, float64x1_t __p1, float64x1_t __p2) {
   float64x1_t __ret;
-  float64x2_t __va = vcombine_f64(__p0, (float64_t)0);
-  float64x2_t __vb = vcombine_f64(__p1, (float64_t)0);
-  float64x2_t __vc = vcombine_f64(__p2, (float64_t)0);
+  float64x2_t __va = vcombine_f64(__p0, vdup_n_f64(0.0));
+  float64x2_t __vb = vcombine_f64(__p1, vdup_n_f64(0.0));
+  float64x2_t __vc = vcombine_f64(__p2, vdup_n_f64(0.0));
   float64x2_t __vres = vcmlaq_rot90_f64(__va, __vb, __vc);
   __ret = vget_low_f64(__vres);
   return __ret;
