diff -u a/third_party/intel/clang/xmmintrin.h b/third_party/intel/clang/xmmintrin.h
--- a/third_party/intel/clang/xmmintrin.h
+++ b/third_party/intel/clang/xmmintrin.h
@@ -1712,6 +1712,7 @@
 {
   return _mm_cvtpi32_ps(__a, __b);
 }
+#endif /* COSMO_DISABLE_MMX */
 
 /// Extracts a float value contained in the lower 32 bits of a vector of
 ///    [4 x float].
@@ -2241,6 +2242,7 @@
 ///    A pointer to an aligned memory location used to store the register value.
 /// \param __a
 ///    A 64-bit integer containing the value to be stored.
+#if !defined(COSMO_DISABLE_MMX)
 static __inline__ void __DEFAULT_FN_ATTRS_MMX
 _mm_stream_pi(void *__p, __m64 __a)
 {
@@ -2577,6 +2579,7 @@
 {
   return (__m64)__builtin_ia32_psadbw((__v8qi)__a, (__v8qi)__b);
 }
+#endif /* COSMO_DISABLE_MMX */
 
 #if defined(__cplusplus)
 extern "C" {
@@ -2851,13 +2854,13 @@
 ///
 /// This intrinsic corresponds to the <c> CVTPI2PS + COMPOSITE </c> instruction.
 ///
+#if !defined(COSMO_DISABLE_MMX)
 /// \param __a
 ///    A 64-bit vector of [4 x i16]. The elements of the destination are copied
 ///    from the corresponding elements in this operand.
 /// \returns A 128-bit vector of [4 x float] containing the copied and converted
 ///    values from the operand.
-static __inline__ __m128 __DEFAULT_FN_ATTRS_MMX
-_mm_cvtpi16_ps(__m64 __a)
+static __inline__ __m128 __DEFAULT_FN_ATTRS_MMX _mm_cvtpi16_ps(__m64 __a)
 {
   __m64 __b, __c;
   __m128 __r;
@@ -3036,6 +3039,7 @@
 
   return _mm_packs_pi16(__b, __c);
 }
+#endif /* COSMO_DISABLE_MMX */
 
 /// Extracts the sign bits from each single-precision floating-point
 ///    element of a 128-bit floating-point vector of [4 x float] and returns the
@@ -3189,6 +3193,7 @@
   (row2) = _mm_movelh_ps(tmp1, tmp3); \
   (row3) = _mm_movehl_ps(tmp3, tmp1); \
 } while (0)
+#if !defined(COSMO_DISABLE_MMX)
 
 /* Aliases for compatibility. */
 #define _m_pextrw _mm_extract_pi16
@@ -3205,7 +3210,6 @@
 #define _m_pavgw _mm_avg_pu16
 #define _m_psadbw _mm_sad_pu8
 #define _m_ _mm_
-
 #endif /* COSMO_DISABLE_MMX */
 
 #undef __DEFAULT_FN_ATTRS
